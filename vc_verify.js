// import { JwtCredentialPayload, createVerifiableCredentialJwt } from 'did-jwt-vc'
import { ES256KSigner, hexToBytes, decodeJWT } from 'did-jwt';
import { createVerifiableCredentialJwt, createVerifiablePresentationJwt, verifyCredential, verifyPresentation } from 'did-jwt-vc'
import { Resolver } from 'did-resolver'
import { getResolver } from 'web-did-resolver'

const vcJwt = 'eyJhbGciOiJFUzI1NksiLCJ0eXAiOiJKV1QifQ.eyJ2YyI6eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvMjAxOC9jcmVkZW50aWFscy92MSJdLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIl0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7InVlIjp7Il9pZCI6IjY0MmM1ZTA0NzQwNjRjZTQyN2ZmMGE5NiIsInNjaGVtYV92ZXJzaW9uIjoxLCJpbXNpIjoiOTk5NzAwMDAwMDAwMDAxIiwibXNpc2RuIjpbXSwiaW1laXN2IjoiNDM3MDgxNjEyNTgxNjE1MSIsIm1tZV9ob3N0IjpbXSwibW1lX3JlYWxtIjpbXSwicHVyZ2VfZmxhZyI6W10sInNlY3VyaXR5Ijp7ImsiOiI0NjVCNUNFOCBCMTk5QjQ5RiBBQTVGMEEyRSBFMjM4QTZCQyIsIm9wIjpudWxsLCJvcGMiOiJFOEVEMjg5RCBFQkE5NTJFNCAyODNCNTRFOCA4RTYxODNDQSIsImFtZiI6IjgwMDAiLCJzcW4iOjEyODF9LCJhbWJyIjp7ImRvd25saW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfSwidXBsaW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfX0sInNsaWNlIjpbeyJzc3QiOjEsImRlZmF1bHRfaW5kaWNhdG9yIjp0cnVlLCJzZXNzaW9uIjpbeyJuYW1lIjoiaW50ZXJuZXQiLCJ0eXBlIjozLCJxb3MiOnsiaW5kZXgiOjksImFycCI6eyJwcmlvcml0eV9sZXZlbCI6OCwicHJlX2VtcHRpb25fY2FwYWJpbGl0eSI6MSwicHJlX2VtcHRpb25fdnVsbmVyYWJpbGl0eSI6MX19LCJhbWJyIjp7ImRvd25saW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfSwidXBsaW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfX0sIl9pZCI6IjY0MmM1ZTA0NzQwNjRjZTQyN2ZmMGE5OCIsInBjY19ydWxlIjpbXX1dLCJfaWQiOiI2NDJjNWUwNDc0MDY0Y2U0MjdmZjBhOTcifV0sImFjY2Vzc19yZXN0cmljdGlvbl9kYXRhIjozMiwic3Vic2NyaWJlcl9zdGF0dXMiOjAsIm5ldHdvcmtfYWNjZXNzX21vZGUiOjAsInN1YnNjcmliZWRfcmF1X3RhdV90aW1lciI6MTIsIl9fdiI6MH19fSwic3ViIjoiZGlkOndlYjpwZm95dGlrLmdpdGh1Yi5pbyIsIm5iZiI6MTU2Mjk1MDI4MiwiaXNzIjoiZGlkOndlYjpwZm95dGlrLmdpdGh1Yi5pbyJ9.VJ-9jrJz2BA0u24vkbi1xY8AqTB4gfdSMVh6sYA2to6Twf1I7TXcEr87pyxI_mtidd08qXufVMXiwtqVAlr9ww'

const vpJwt = 'eyJhbGciOiJFUzI1NksiLCJ0eXAiOiJKV1QifQ.eyJ2cCI6eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvMjAxOC9jcmVkZW50aWFscy92MSJdLCJ0eXBlIjpbIlZlcmlmaWFibGVQcmVzZW50YXRpb24iXSwidmVyaWZpYWJsZUNyZWRlbnRpYWwiOlsiZXlKaGJHY2lPaUpGVXpJMU5rc2lMQ0owZVhBaU9pSktWMVFpZlEuZXlKMll5STZleUpBWTI5dWRHVjRkQ0k2V3lKb2RIUndjem92TDNkM2R5NTNNeTV2Y21jdk1qQXhPQzlqY21Wa1pXNTBhV0ZzY3k5Mk1TSmRMQ0owZVhCbElqcGJJbFpsY21sbWFXRmliR1ZEY21Wa1pXNTBhV0ZzSWwwc0ltTnlaV1JsYm5ScFlXeFRkV0pxWldOMElqcDdJblZsSWpwN0lsOXBaQ0k2SWpZME1tTTFaVEEwTnpRd05qUmpaVFF5TjJabU1HRTVOaUlzSW5OamFHVnRZVjkyWlhKemFXOXVJam94TENKcGJYTnBJam9pT1RrNU56QXdNREF3TURBd01EQXhJaXdpYlhOcGMyUnVJanBiWFN3aWFXMWxhWE4ySWpvaU5ETTNNRGd4TmpFeU5UZ3hOakUxTVNJc0ltMXRaVjlvYjNOMElqcGJYU3dpYlcxbFgzSmxZV3h0SWpwYlhTd2ljSFZ5WjJWZlpteGhaeUk2VzEwc0luTmxZM1Z5YVhSNUlqcDdJbXNpT2lJME5qVkNOVU5GT0NCQ01UazVRalE1UmlCQlFUVkdNRUV5UlNCRk1qTTRRVFpDUXlJc0ltOXdJanB1ZFd4c0xDSnZjR01pT2lKRk9FVkVNamc1UkNCRlFrRTVOVEpGTkNBeU9ETkNOVFJGT0NBNFJUWXhPRE5EUVNJc0ltRnRaaUk2SWpnd01EQWlMQ0p6Y1c0aU9qRXlPREY5TENKaGJXSnlJanA3SW1SdmQyNXNhVzVySWpwN0luWmhiSFZsSWpveExDSjFibWwwSWpvemZTd2lkWEJzYVc1cklqcDdJblpoYkhWbElqb3hMQ0oxYm1sMElqb3pmWDBzSW5Oc2FXTmxJanBiZXlKemMzUWlPakVzSW1SbFptRjFiSFJmYVc1a2FXTmhkRzl5SWpwMGNuVmxMQ0p6WlhOemFXOXVJanBiZXlKdVlXMWxJam9pYVc1MFpYSnVaWFFpTENKMGVYQmxJam96TENKeGIzTWlPbnNpYVc1a1pYZ2lPamtzSW1GeWNDSTZleUp3Y21sdmNtbDBlVjlzWlhabGJDSTZPQ3dpY0hKbFgyVnRjSFJwYjI1ZlkyRndZV0pwYkdsMGVTSTZNU3dpY0hKbFgyVnRjSFJwYjI1ZmRuVnNibVZ5WVdKcGJHbDBlU0k2TVgxOUxDSmhiV0p5SWpwN0ltUnZkMjVzYVc1cklqcDdJblpoYkhWbElqb3hMQ0oxYm1sMElqb3pmU3dpZFhCc2FXNXJJanA3SW5aaGJIVmxJam94TENKMWJtbDBJam96Zlgwc0lsOXBaQ0k2SWpZME1tTTFaVEEwTnpRd05qUmpaVFF5TjJabU1HRTVPQ0lzSW5CalkxOXlkV3hsSWpwYlhYMWRMQ0pmYVdRaU9pSTJOREpqTldVd05EYzBNRFkwWTJVME1qZG1aakJoT1RjaWZWMHNJbUZqWTJWemMxOXlaWE4wY21samRHbHZibDlrWVhSaElqb3pNaXdpYzNWaWMyTnlhV0psY2w5emRHRjBkWE1pT2pBc0ltNWxkSGR2Y210ZllXTmpaWE56WDIxdlpHVWlPakFzSW5OMVluTmpjbWxpWldSZmNtRjFYM1JoZFY5MGFXMWxjaUk2TVRJc0lsOWZkaUk2TUgxOWZTd2ljM1ZpSWpvaVpHbGtPbmRsWWpwd1ptOTVkR2xyTG1kcGRHaDFZaTVwYnlJc0ltNWlaaUk2TVRVMk1qazFNREk0TWl3aWFYTnpJam9pWkdsa09uZGxZanB3Wm05NWRHbHJMbWRwZEdoMVlpNXBieUo5LlZKLTlqckp6MkJBMHUyNHZrYmkxeFk4QXFUQjRnZmRTTVZoNnNZQTJ0bzZUd2YxSTdUWGNFcjg3cHl4SV9tdGlkZDA4cVh1ZlZNWGl3dHFWQWxyOXd3Il0sInVlIjp7Il9pZCI6IjY0MmM1ZTA0NzQwNjRjZTQyN2ZmMGE5NiIsInNjaGVtYV92ZXJzaW9uIjoxLCJpbXNpIjoiOTk5NzAwMDAwMDAwMDAxIiwibXNpc2RuIjpbXSwiaW1laXN2IjoiNDM3MDgxNjEyNTgxNjE1MSIsIm1tZV9ob3N0IjpbXSwibW1lX3JlYWxtIjpbXSwicHVyZ2VfZmxhZyI6W10sInNlY3VyaXR5Ijp7ImsiOiI0NjVCNUNFOCBCMTk5QjQ5RiBBQTVGMEEyRSBFMjM4QTZCQyIsIm9wIjpudWxsLCJvcGMiOiJFOEVEMjg5RCBFQkE5NTJFNCAyODNCNTRFOCA4RTYxODNDQSIsImFtZiI6IjgwMDAiLCJzcW4iOjEyODF9LCJhbWJyIjp7ImRvd25saW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfSwidXBsaW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfX0sInNsaWNlIjpbeyJzc3QiOjEsImRlZmF1bHRfaW5kaWNhdG9yIjp0cnVlLCJzZXNzaW9uIjpbeyJuYW1lIjoiaW50ZXJuZXQiLCJ0eXBlIjozLCJxb3MiOnsiaW5kZXgiOjksImFycCI6eyJwcmlvcml0eV9sZXZlbCI6OCwicHJlX2VtcHRpb25fY2FwYWJpbGl0eSI6MSwicHJlX2VtcHRpb25fdnVsbmVyYWJpbGl0eSI6MX19LCJhbWJyIjp7ImRvd25saW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfSwidXBsaW5rIjp7InZhbHVlIjoxLCJ1bml0IjozfX0sIl9pZCI6IjY0MmM1ZTA0NzQwNjRjZTQyN2ZmMGE5OCIsInBjY19ydWxlIjpbXX1dLCJfaWQiOiI2NDJjNWUwNDc0MDY0Y2U0MjdmZjBhOTcifV0sImFjY2Vzc19yZXN0cmljdGlvbl9kYXRhIjozMiwic3Vic2NyaWJlcl9zdGF0dXMiOjAsIm5ldHdvcmtfYWNjZXNzX21vZGUiOjAsInN1YnNjcmliZWRfcmF1X3RhdV90aW1lciI6MTIsIl9fdiI6MH19LCJpc3MiOiJkaWQ6d2ViOnBmb3l0aWsuZ2l0aHViLmlvIn0.aI0zGwV7egc5Y3Km3yDeMouG3Y6_YuFEPyxFZJWP6FaARRbnAy8jILlYCZxjzu6PHT-RC_2iEqF-DKvJ5bmLOg' 

// Prepare the did:web resolver
const resolver = new Resolver(getResolver())

// Verify the Credentantial and the Presentation
const decodedCred = decodeJWT(vcJwt)
console.log('ue imsi:', decodedCred['payload']['vc']['credentialSubject']['ue']['imsi'])
const verifiedVC = await verifyCredential(vcJwt, resolver)
console.log('VerifiedCredentials:', verifiedVC['verified'])

const verifiedVP = await verifyPresentation(vpJwt, resolver)
console.log('VerifiedPresentation:', verifiedVP['verified'])

